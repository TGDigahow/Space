<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpaceMaps</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: Arial, sans-serif;
            background-color: #e6f2f2;
            padding: 20px;
            height: 100vh;
            margin: 0;
            color: #333;
        }
        img.logo {
            width: 120px;
            height: auto;
            margin-bottom: 20px;
        }
        label, select, button {
            margin: 10px 0;
            font-size: 16px;
        }
        button {
            padding: 10px;
            background-color: #5c85d6;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #4a73c2;
        }
    </style>
</head>
<body>
    <img src="https://raw.githubusercontent.com/TGDigahow/Space/main/spacemapslogo.png" alt="Logomarca" class="logo">
    <label for="destination">Onde quer ir?</label>
    <select id="destination">
        <option value="Biblioteca">Biblioteca</option>
        <option value="Financeiro">Financeiro</option>
        <option value="Secretaria">Secretaria</option>
        <option value="Sala 2.3">Sala 2.3</option>
    </select>
    <button id="start-voice-recognition-btn">Iniciar reconhecimento de voz</button>
    <div id="miniplayer-container" class="content" aria-live="assertive"></div>

    <script>
        const falar = (mensagem) => {
            const utterance = new SpeechSynthesisUtterance(mensagem);
            utterance.lang = 'pt-BR';
            speechSynthesis.speak(utterance);
        };

        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.lang = 'pt-BR';
        recognition.continuous = true;

        let isAccessibilityActive = false;

        recognition.onresult = (event) => {
            const transcript = event.results[event.results.length - 1][0].transcript.trim().toLowerCase();

            if (transcript === "olá space" && !isAccessibilityActive) {
                isAccessibilityActive = true;
                falar("Acessibilidade ativada. Onde deseja ir?");
            } else if (isAccessibilityActive) {
                if (transcript.includes("obrigado space")) {
                    isAccessibilityActive = false;
                    falar("Acessibilidade desativada. Até logo.");
                } else {
                    const destination = document.getElementById('destination').value;
                    falar(`Carregando rota para ${destination}.`);
                    carregarRota(destination);
                }
            }
        };

        recognition.onerror = (event) => {
            console.error("Erro no reconhecimento de voz:", event.error);
            falar("Erro no reconhecimento de voz.");
        };

        document.getElementById('start-voice-recognition-btn').addEventListener('click', () => {
            recognition.start();
            falar("Reconhecimento de voz iniciado.");
        });

        const carregarRota = (destino) => {
            const container = document.getElementById('miniplayer-container');
            const rotas = {
                "Biblioteca": ["Siga em frente", "Vire à direita", "A Biblioteca estará à esquerda"],
                "Financeiro": ["Vire à esquerda", "Siga até o final do corredor"],
                "Secretaria": ["Siga em frente", "Passe pelo auditório", "A Secretaria estará à frente"],
                "Sala 2.3": ["Vire à esquerda", "Siga até a segunda porta à direita"]
            };
            const instrucoes = rotas[destino];
            container.innerHTML = `<p><strong>Instruções:</strong><br>${instrucoes.join('<br>')}</p>`;
            instrucoes.forEach((passo) => falar(passo));
        };
    </script>
</body>
</html>
